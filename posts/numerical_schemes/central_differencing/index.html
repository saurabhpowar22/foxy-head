<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css integrity=sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js integrity=sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8 crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous onload=renderMathInElement(document.body)></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]})})</script><title>Numerical Schemes : Central Differencing | Foxy Head</title>
<meta name=keywords content="CD,Central Differencing,Numerical Schemes,Peclet Number,FVM,CFD"><meta name=description content="CFD numerical scheme central differencing"><meta name=author content="Saurabh Powar"><link rel=canonical href=https://saurabhpowar22.github.io/foxy-head/posts/numerical_schemes/central_differencing/><link crossorigin=anonymous href=/foxy-head/assets/css/stylesheet.f5a36cb35430f3b51d35d4e54230c0d76f187275350a133fa730bf322a520bd7.css integrity="sha256-9aNss1Qw87UdNdTlQjDA128YcnU1ChM/pzC/MipSC9c=" rel="preload stylesheet" as=style><link rel=icon href=https://saurabhpowar22.github.io/foxy-head/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://saurabhpowar22.github.io/foxy-head/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://saurabhpowar22.github.io/foxy-head/favicon-32x32.png><link rel=apple-touch-icon href=https://saurabhpowar22.github.io/foxy-head/apple-touch-icon.png><link rel=mask-icon href=https://saurabhpowar22.github.io/foxy-head/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://saurabhpowar22.github.io/foxy-head/posts/numerical_schemes/central_differencing/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-C2P9SDZ3JZ"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-C2P9SDZ3JZ",{anonymize_ip:!1})}</script><meta property="og:title" content="Numerical Schemes : Central Differencing"><meta property="og:description" content="CFD numerical scheme central differencing"><meta property="og:type" content="article"><meta property="og:url" content="https://saurabhpowar22.github.io/foxy-head/posts/numerical_schemes/central_differencing/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-03-29T23:03:30+05:30"><meta property="article:modified_time" content="2024-03-29T23:03:30+05:30"><meta property="og:site_name" content="Foxy Head"><meta name=twitter:card content="summary"><meta name=twitter:title content="Numerical Schemes : Central Differencing"><meta name=twitter:description content="CFD numerical scheme central differencing"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://saurabhpowar22.github.io/foxy-head/posts/"},{"@type":"ListItem","position":2,"name":"Numerical Schemes : Central Differencing","item":"https://saurabhpowar22.github.io/foxy-head/posts/numerical_schemes/central_differencing/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Numerical Schemes : Central Differencing","name":"Numerical Schemes : Central Differencing","description":"CFD numerical scheme central differencing","keywords":["CD","Central Differencing","Numerical Schemes","Peclet Number","FVM","CFD"],"articleBody":" What are numerical schemes you may ask,\nIn finite volume method, numerical schemes are about finding the values of fluid property $\\phi$ at cell faces (such as temperature, velocity, etc.) All the numerical schemes developed address a particular problem, how cell face values are calculated depending upon flow conditions and information propagation through numerics\nTo provide some context we will look at transport equation and how its discretized in FVM method\nReynolds transport equation and discretization \\[ \\begin{align} \\frac{\\partial (\\rho \\phi)}{\\partial t} + div(\\rho \\vec{U} \\phi) = div(\\Gamma \\nabla(\\phi)) + S_\\phi \\end{align} \\]\nFor simplicity we will look at only convection and diffusion of flow, dropping time-variant and source terms\n\\[ \\begin{align} div(\\rho \\vec{U} \\phi) = div(\\Gamma \\nabla(\\phi)) \\end{align} \\]\nFVM Discretization of convection-diffusion equation For 1 dimensional case we can discretize this equation as,\n\\[ \\begin{align} (\\rho A u \\phi)_e - (\\rho A u \\phi)_w = \\left( \\Gamma A \\frac{d\\phi}{dx} \\right)_e - \\left( \\Gamma A \\frac{d\\phi}{dx} \\right)_w \\end{align} \\]\nAfter seeing above equation we can see that we need values at cell faces of control volume\nWe can simplify above scary looking equation by clubbing terms, which denote convection flux and diffusion strength\nConvection Flux (Mass flux per unit area) \\[ \\begin{align} F = \\rho u \\end{align} \\]\nDiffusion Strength (Diffusion conductance at cell faces) \\[ \\begin{align} D = \\frac{\\Gamma}{dx} \\end{align} \\]\nWith these substitutions Convection-Diffusion equation is written as,\n\\[ \\begin{align} F_e \\rho_e - F_w \\rho_w = D_e (\\phi_E - \\phi_P) - D_w (\\phi_P - \\phi_W) \\end{align} \\]\nSuppose, if we have flow going from west to east direction, then node W is called Upstream node and node E is called Downstream node.\nCentral Differencing (CD) scheme With our basic expression ready we can jumps to main discussion of Central Differencing scheme\nIn central differencing scheme we use linear interpolation between cell centres to find value at cell faces (simple enough!!)\nWith constant grid size we can have\n\\[ \\begin{align} \\phi_e = \\frac{\\phi_E + \\phi_P}{2} \\end{align} \\]\n\\[ \\begin{align} \\phi_w = \\frac{\\phi_P + \\phi_W}{2} \\end{align} \\]\nso applying our above scheme to equation of convection diffusion we have,\n\\[ \\begin{align} a_P \\phi_P = a_W \\phi_W + a_E \\phi_E \\end{align} \\]\nwith coefficients having values\n$a_W$ $a_E$ $a_P$ $D_w + \\frac{F_w}{2}$ $D_e - \\frac{F_e}{2}$ $a_W + a_E + (F_e - F_w)$ with central differencing scheme defined, we write equation for each node in CFD grid and arrange it in matrix format $AX=B$.\nWith $A$ representing coefficients matrix, $X$ representing value of $\\phi$ at each nodal point and $B$ representing sources terms originated from boundary conditions\nThe matrix can be solved by iterative methods such as TDMA.\nNumerical Solution obtained by Central Differencing Its well and good of arranging equations and solving the matrix but how good is the solution obtained by central differencing method to the real solution.\nFor analysing the result we look at $F/D$ ratio of corresponding to grid and flow, which is convection to diffusion strength also known as peclet number.\n\\[ \\begin{align} Pe = \\frac{F}{D} = \\frac{\\rho u}{\\Gamma} dx \\end{align} \\]\nLow F/D Ratio High F/D Ratio From above diagram we can see with high $Pe$, solution starts oscillating (wiggles). So what are the causes that leads to oscillating solution.\nFrom relation (10), we find out 3 factors affecting $Pe$,\nFlow velocity ($u$) Diffusion coefficient Grid Spacing If the velocity (convection strength) of flow is very high then it dominates information propagation (from downstream node), but our CD scheme carries equal weight for downstream and upstream node to calculates $\\phi$ value and does not recognize high convection strength of flow\nResulting in oscillations or wiggles in our solution that we see in high $F/D$ solution\nLimit of Peclet Number ($Pe$) for solution to be stable For our solution to be wiggle free we need to limit $Pe$ to be less than 2.\nTo understand this limit we have to look at the boundedness criterion of numerical schemes.\nBoundedness states that, in absence of sources the value of $\\phi$ at node should be within the range of its neighbouring nodes (making coefficient matrix diagonally dominant which is necessary condition for convergence of solution) and all the coefficients of discretized equation should have same sign (usually positive)\nThe second statement is of our interest in explanation of wiggles in solution.\nReferring to coefficients of CD discretization,\n$a_W$ $a_E$ $a_P$ $D_w + \\frac{F_w}{2}$ $D_e - \\frac{F_e}{2}$ $a_W + a_E + (F_e - F_w)$ from relation (4) and (5) we can say $F$ and $D$ are always positive, hence only $a_E$ has possibility of having negative value when convection strength dominates.\nto avoid that,\n\\[ \\begin{align} D - \\frac{F}{2} \u003e 0 \\end{align} \\]\nsolving above inequality we get $F/D \u003c 2$ or $Pe \u003c2$\nSo to solve this problem we have to increase our diffusion strength which can be done by reducing the grid size ($dx$) as defined in equation(5), reducing the $Pe$. But this increases computation time of solution hence for high velocity flows central differencing scheme is not viable.\nOther Remarks Accuracy of scheme : Central differencing scheme is 2nd order accurate Transportiveness Property : As discussed earlier, central differencing scheme does not take into convection strength and direction of flow, hence it lacks transportiveness property References https://en.wikipedia.org/wiki/Central_differencing_scheme\nAn Introduction to Computational Fluid Dynamics: The Finite Volume Method (ISBN : 9780470235157)\n","wordCount":"884","inLanguage":"en","datePublished":"2024-03-29T23:03:30+05:30","dateModified":"2024-03-29T23:03:30+05:30","author":{"@type":"Person","name":"Saurabh Powar"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://saurabhpowar22.github.io/foxy-head/posts/numerical_schemes/central_differencing/"},"publisher":{"@type":"Organization","name":"Foxy Head","logo":{"@type":"ImageObject","url":"https://saurabhpowar22.github.io/foxy-head/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://saurabhpowar22.github.io/foxy-head/ accesskey=h title="Foxy Head (Alt + H)">Foxy Head</a><div class=logo-switches><ul class=lang-switch><li></li></ul></div></div><ul id=menu><li><a href=https://saurabhpowar22.github.io/foxy-head/posts/ title=Articles><span>Articles</span></a></li><li><a href=https://saurabhpowar22.github.io/foxy-head/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://saurabhpowar22.github.io/foxy-head/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://saurabhpowar22.github.io/foxy-head/about_me/ title="About Me"><span>About Me</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://saurabhpowar22.github.io/foxy-head/>Home</a>&nbsp;»&nbsp;<a href=https://saurabhpowar22.github.io/foxy-head/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Numerical Schemes : Central Differencing</h1><div class=post-meta><span title='2024-03-29 23:03:30 +0530 IST'>March 29, 2024</span>&nbsp;·&nbsp;Saurabh Powar</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><ul><li><a href=#reynolds-transport-equation-and-discretization aria-label="Reynolds transport equation and discretization">Reynolds transport equation and discretization</a></li></ul><li><a href=#fvm-discretization-of-convection-diffusion-equation aria-label="FVM Discretization of convection-diffusion equation">FVM Discretization of convection-diffusion equation</a></li><li><a href=#central-differencing-cd-scheme aria-label="Central Differencing (CD) scheme">Central Differencing (CD) scheme</a><ul><li><a href=#numerical-solution-obtained-by-central-differencing aria-label="Numerical Solution obtained by Central Differencing">Numerical Solution obtained by Central Differencing</a></li><li><a href=#limit-of-peclet-number-pe-for-solution-to-be-stable aria-label="Limit of Peclet Number ($Pe$) for solution to be stable">Limit of Peclet Number ($Pe$) for solution to be stable</a></li><li><a href=#other-remarks aria-label="Other Remarks">Other Remarks</a></li></ul></li><li><a href=#references aria-label=References>References</a></li></ul></div></details></div><div class=post-content><style>*{box-sizing:border-box}.column{float:left;width:50%;padding:5px}.row::after{content:"";clear:both;display:table}</style><p>What are numerical schemes you may ask,</p><p>In finite volume method, numerical schemes are about finding the values of fluid property $\phi$ at cell faces (such as temperature, velocity, etc.)
<img loading=lazy src=images/1D_CV_naming.png alt="Control Volume"></p><p>All the numerical schemes developed address a particular problem, how cell face values are calculated depending upon flow conditions and information propagation through numerics</p><p>To provide some context we will look at transport equation and how its discretized in FVM method</p><h3 id=reynolds-transport-equation-and-discretization>Reynolds transport equation and discretization</h3><p>\[
\begin{align}
\frac{\partial (\rho \phi)}{\partial t} + div(\rho \vec{U} \phi) = div(\Gamma \nabla(\phi)) + S_\phi
\end{align}
\]</p><p>For simplicity we will look at only convection and diffusion of flow, dropping time-variant and source terms</p><p>\[
\begin{align}
div(\rho \vec{U} \phi) = div(\Gamma \nabla(\phi))
\end{align}
\]</p><h2 id=fvm-discretization-of-convection-diffusion-equation>FVM Discretization of convection-diffusion equation</h2><p>For 1 dimensional case we can discretize this equation as,</p><p><img loading=lazy src=images/1D_CV.png alt="Control Volume naming"></p><p>\[
\begin{align}
(\rho A u \phi)_e - (\rho A u \phi)_w = \left( \Gamma A \frac{d\phi}{dx} \right)_e - \left( \Gamma A \frac{d\phi}{dx} \right)_w
\end{align}
\]</p><p>After seeing above equation we can see that we need values at cell faces of control volume</p><p>We can simplify above scary looking equation by clubbing terms, which denote convection flux and diffusion strength</p><ul><li><p>Convection Flux (Mass flux per unit area)
\[
\begin{align}
F = \rho u
\end{align}
\]</p></li><li><p>Diffusion Strength (Diffusion conductance at cell faces)
\[
\begin{align}
D = \frac{\Gamma}{dx}
\end{align}
\]</p></li></ul><p>With these substitutions Convection-Diffusion equation is written as,</p><p>\[
\begin{align}
F_e \rho_e - F_w \rho_w = D_e (\phi_E - \phi_P) - D_w (\phi_P - \phi_W)
\end{align}
\]</p><p>Suppose, if we have flow going from west to east direction, then node W is called <strong>Upstream node</strong> and node E is called <strong>Downstream node</strong>.</p><h2 id=central-differencing-cd-scheme>Central Differencing (CD) scheme</h2><p>With our basic expression ready we can jumps to main discussion of Central Differencing scheme</p><p>In central differencing scheme we use linear interpolation between cell centres to find value at cell faces (simple enough!!)</p><p>With constant grid size we can have</p><p>\[
\begin{align}
\phi_e = \frac{\phi_E + \phi_P}{2}
\end{align}
\]</p><p>\[
\begin{align}
\phi_w = \frac{\phi_P + \phi_W}{2}
\end{align}
\]</p><p>so applying our above scheme to equation of convection diffusion we have,</p><p>\[
\begin{align}
a_P \phi_P = a_W \phi_W + a_E \phi_E
\end{align}
\]</p><p>with coefficients having values</p><table><thead><tr><th style=text-align:center>$a_W$</th><th style=text-align:center>$a_E$</th><th style=text-align:center>$a_P$</th></tr></thead><tbody><tr><td style=text-align:center>$D_w + \frac{F_w}{2}$</td><td style=text-align:center>$D_e - \frac{F_e}{2}$</td><td style=text-align:center>$a_W + a_E + (F_e - F_w)$</td></tr></tbody></table><p>with central differencing scheme defined, we write equation for each node in CFD grid and arrange it in matrix format $AX=B$.</p><p>With $A$ representing coefficients matrix, $X$ representing value of $\phi$ at each nodal point and $B$ representing sources terms originated from boundary conditions</p><p>The matrix can be solved by iterative methods such as <a href=https://en.wikipedia.org/wiki/Tridiagonal_matrix_algorithm>TDMA</a>.</p><h3 id=numerical-solution-obtained-by-central-differencing>Numerical Solution obtained by Central Differencing</h3><p>Its well and good of arranging equations and solving the matrix but how good is the solution obtained by central differencing method to the real solution.</p><p>For analysing the result we look at $F/D$ ratio of corresponding to grid and flow, which is convection to diffusion strength also known as <strong>peclet number</strong>.</p><p>\[
\begin{align}
Pe = \frac{F}{D} = \frac{\rho u}{\Gamma} dx
\end{align}
\]</p><div class=row><div class=column><img src=images/Low_FD_Ratio.png alt="Low F/D ratio"><center><figcaption>Low F/D Ratio</figcaption></center></div><div class=column><img src=images/High_FD_Ratio.png alt="High F/D ratio"><center><figcaption>High F/D Ratio</figcaption></center></div></div><p>From above diagram we can see with high $Pe$, solution starts oscillating (wiggles).
So what are the causes that leads to oscillating solution.<br>From relation (10), we find out 3 factors affecting $Pe$,</p><ul><li>Flow velocity ($u$)</li><li>Diffusion coefficient</li><li>Grid Spacing</li></ul><p>If the velocity (convection strength) of flow is very high then it dominates information propagation (from downstream node), but our CD scheme carries equal weight for downstream and upstream node to calculates $\phi$ value and does not recognize high convection strength of flow</p><p><img loading=lazy src=images/cv_trying_to_catch_info.png alt=catching></p><p>Resulting in oscillations or wiggles in our solution that we see in high $F/D$ solution</p><h3 id=limit-of-peclet-number-pe-for-solution-to-be-stable>Limit of Peclet Number ($Pe$) for solution to be stable</h3><p>For our solution to be wiggle free we need to limit $Pe$ to be less than 2.</p><p>To understand this limit we have to look at the boundedness criterion of numerical schemes.</p><p>Boundedness states that, in absence of sources the value of $\phi$ at node should be within the range of its neighbouring nodes (making coefficient matrix diagonally dominant which is necessary condition for convergence of solution) and all the coefficients of discretized equation should have same sign (usually positive)</p><p>The second statement is of our interest in explanation of wiggles in solution.</p><p>Referring to coefficients of CD discretization,</p><table><thead><tr><th style=text-align:center>$a_W$</th><th style=text-align:center>$a_E$</th><th style=text-align:center>$a_P$</th></tr></thead><tbody><tr><td style=text-align:center>$D_w + \frac{F_w}{2}$</td><td style=text-align:center>$D_e - \frac{F_e}{2}$</td><td style=text-align:center>$a_W + a_E + (F_e - F_w)$</td></tr></tbody></table><p>from relation (4) and (5) we can say $F$ and $D$ are always positive, hence only $a_E$ has possibility of having negative value when convection strength dominates.</p><p>to avoid that,</p><p>\[
\begin{align}
D - \frac{F}{2} > 0
\end{align}
\]</p><p>solving above inequality we get $F/D &lt; 2$ or $Pe &lt;2$</p><p>So to solve this problem we have to increase our diffusion strength which can be done by reducing the grid size ($dx$) as defined in equation(5), reducing the $Pe$. But this increases computation time of solution hence for high velocity flows central differencing scheme is not viable.</p><h3 id=other-remarks>Other Remarks</h3><ul><li>Accuracy of scheme : Central differencing scheme is 2nd order accurate</li><li>Transportiveness Property : As discussed earlier, central differencing scheme does not take into convection strength and direction of flow, hence it lacks transportiveness property</li></ul><h2 id=references>References</h2><ol><li><p><a href=https://en.wikipedia.org/wiki/Central_differencing_scheme>https://en.wikipedia.org/wiki/Central_differencing_scheme</a></p></li><li><p>An Introduction to Computational Fluid Dynamics: The Finite Volume Method (ISBN : 9780470235157)</p></li></ol></div><footer class=post-footer><ul class=post-tags><li><a href=https://saurabhpowar22.github.io/foxy-head/tags/cd/>CD</a></li><li><a href=https://saurabhpowar22.github.io/foxy-head/tags/central-differencing/>Central Differencing</a></li><li><a href=https://saurabhpowar22.github.io/foxy-head/tags/numerical-schemes/>Numerical Schemes</a></li><li><a href=https://saurabhpowar22.github.io/foxy-head/tags/peclet-number/>Peclet Number</a></li><li><a href=https://saurabhpowar22.github.io/foxy-head/tags/fvm/>FVM</a></li><li><a href=https://saurabhpowar22.github.io/foxy-head/tags/cfd/>CFD</a></li></ul><nav class=paginav><a class=next href=https://saurabhpowar22.github.io/foxy-head/posts/sub_derivative/><span class=title>Next »</span><br><span>Substantial Derivative</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://saurabhpowar22.github.io/foxy-head/>Foxy Head</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>